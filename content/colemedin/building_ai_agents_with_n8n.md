---
title: Building AI Agents with n8n
videoId: JyolNYRbAcs
---

From: [[colemedin]] <br/> 

[[N8N in creating AI agents | N8N]] is widely used for [[building_ai_agents_with_no_code_using_n8n_and_langchain | building AI agents]], offering an incredibly easy way to create simple yet powerful AI agents without writing any code <a class="yt-timestamp" data-t="00:00:00">[00:00:00]</a>. However, [[prototyping_ai_agents_using_n8n | building an agent]] with n8n often requires a front end for users to interact with it cleanly and simply <a class="yt-timestamp" data-t="00:00:17">[00:00:17]</a>. While n8n provides a chat widget, it's often insufficient for a good user experience <a class="yt-timestamp" data-t="00:00:28">[00:00:28]</a>. This article explores a powerful combination to build secure interfaces for [[creating_powerful_ai_workflows_with_n8n | n8n AI agents]] that can be created and deployed quickly <a class="yt-timestamp" data-t="00:00:36">[00:00:36]</a>.

## The Preferred Combo for AI Agent Interfaces

Instead of creating a full React or Next.js project or writing extensive code, this approach leverages an LLM to generate the front end <a class="yt-timestamp" data-t="00:00:47">[00:00:47]</a>. The recommended combination includes:

*   **Claude:** Used for generating the Python code for the front end <a class="yt-timestamp" data-t="00:01:25">[00:01:25]</a>. Claude is highly effective at coding with Streamlit <a class="yt-timestamp" data-t="00:01:28">[00:01:28]</a>.
*   **Streamlit:** A Python package that simplifies website building, eliminating the need for JavaScript <a class="yt-timestamp" data-t="00:01:18">[00:01:18]</a>.
*   **Supabase:** Provides easy authentication and is often already used with [[creating_rag_ai_agents_using_n8n | n8n agents]] for features like chat memory and RAG (Retrieval Augmented Generation) <a class="yt-timestamp" data-t="00:01:37">[00:01:37]</a>.

This combination allows for quick and effective development of AI agent interfaces <a class="yt-timestamp" data-t="00:01:09">[00:01:09]</a>.

## Building a Basic Streamlit Interface (Without Authentication)

The initial step involves using Claude to create a basic Streamlit interface for an [[ai_automation_with_n8n | n8n]] agent, initially without robust authentication <a class="yt-timestamp" data-t="00:01:47">[00:01:47]</a>.

### Claude Prompting for the Streamlit App

The first prompt to Claude instructs it to "create a basic Streamlit application with a chat interface to talk to an LLM" <a class="yt-timestamp" data-t="00:02:33">[00:02:33]</a>. Crucially, the prompt specifies the interaction with the LLM via a webhook:

*   **Method:** POST request <a class="yt-timestamp" data-t="00:03:10">[00:03:10]</a>.
*   **Payload:** Needs `session ID` (for chat history in n8n) and `chat input` (user prompt) <a class="yt-timestamp" data-t="00:03:16">[00:03:16]</a>.
*   **Response:** The LLM's response is contained within an `output` key in the JSON response <a class="yt-timestamp" data-t="00:03:33">[00:03:33]</a>.

For initial protection, a basic hardcoded bearer token is used, though it's explicitly noted as unsuitable for production environments <a class="yt-timestamp" data-t="00:02:50">[00:02:50]</a>.

### n8n Workflow Setup for the Front End

To make the [[using_n8n_for_api_workflows_in_ai_agents | n8n agent]] accessible to the front end via a webhook, specific nodes are required:

1.  **Web Hook Trigger:** Added at the start of the workflow <a class="yt-timestamp" data-t="00:05:32">[00:05:32]</a>.
    *   The production URL of this webhook will be used as a placeholder in the Python code <a class="yt-timestamp" data-t="00:05:56">[00:05:56]</a>.
    *   Authentication is set to "Header Auth" with the header name "Authorization" and a value of "Bearer [YourToken]" <a class="yt-timestamp" data-t="00:06:16">[00:06:16]</a>.
    *   The webhook is configured to "Respond to Webhook node" instead of "Immediately" <a class="yt-timestamp" data-t="00:06:57">[00:06:57]</a>.
2.  **Respond to Web Hook:** Added at the very end of the workflow, after the tools agent <a class="yt-timestamp" data-t="00:05:38">[00:05:38]</a>. This node automatically returns output items from the previous node, including the `output` key from the LLM response <a class="yt-timestamp" data-t="00:07:04">[00:07:04]</a>.

The n8n workflow is designed to handle inputs from both the n8n chat widget and the webhook by using an "Edit Fields" node that extracts `chat input` and `session ID` from either source (`json.body.chat input`, `json.body.session ID`) <a class="yt-timestamp" data-t="00:07:36">[00:07:36]</a>. This ensures proper functioning with chat memory (e.g., PostgreSQL Chat Memory) <a class="yt-timestamp" data-t="00:08:12">[00:08:12]</a>.

### Running and Testing

Once the n8n workflow is active and the Streamlit code (generated by Claude) is populated with the webhook URL and bearer token, the Streamlit app can be run using `streamlit run [script_name].py` <a class="yt-timestamp" data-t="00:09:54">[00:09:54]</a>. This opens a simple chat interface in the browser, allowing interaction with the [[creating_rag_ai_agents_using_n8n | RAG AI agent]] running in n8n <a class="yt-timestamp" data-t="00:10:01">[00:10:01]</a>.

## Adding Supabase Authentication

To make the interface robust and secure for production use, Supabase authentication is integrated <a class="yt-timestamp" data-t="00:10:38">[00:10:38]</a>.

### Updating Streamlit App with Claude

The prompt to Claude is updated to "now update this app to use Supabase for authentication" <a class="yt-timestamp" data-t="00:11:07">[00:11:07]</a>. Key instructions for Claude include:

*   Include both login and signup tabs <a class="yt-timestamp" data-t="00:11:11">[00:11:11]</a>.
*   Use the user's Supabase token as the bearer token for the webhook <a class="yt-timestamp" data-t="00:11:19">[00:11:19]</a>. This dynamically generated token is verified in the n8n backend <a class="yt-timestamp" data-t="00:11:33">[00:11:33]</a>.
*   Display user information like email in a left side panel <a class="yt-timestamp" data-t="00:11:57">[00:11:57]</a>.
*   Specify to avoid deprecated features to prevent hallucinations <a class="yt-timestamp" data-t="00:12:04">[00:12:04]</a>.

The generated code will retrieve the user's `access_token` from the Streamlit session state after successful sign-in, which is then passed as the bearer token to n8n <a class="yt-timestamp" data-t="00:12:47">[00:12:47]</a>.

### n8n Workflow Modifications for Supabase Authentication

The n8n workflow needs adjustments to work with the new Supabase bearer token:

1.  **Disable Web Hook Authentication:** Turn off the authentication on the "Web Hook Trigger" node, as verification will now be handled manually in a subsequent step <a class="yt-timestamp" data-t="00:13:30">[00:13:30]</a>.
2.  **HTTP Request for Token Verification:** Add an "HTTP Request" node immediately after the webhook trigger.
    *   **Method:** GET request <a class="yt-timestamp" data-t="00:15:19">[00:15:19]</a>.
    *   **URL:** Your Supabase project URL + `/auth/v1/user` (e.g., `https://[your-project-id].supabase.co/auth/v1/user`) <a class="yt-timestamp" data-t="00:15:22">[00:15:22]</a>.
    *   **Headers:**
        *   `apiKey`: Your Supabase **service role secret key** (private API key, *not* the anonymous public key) <a class="yt-timestamp" data-t="00:14:47">[00:14:47]</a>.
        *   `Authorization`: `json.headers.authorization` â€“ this fetches the user's Supabase token passed from the front end <a class="yt-timestamp" data-t="00:15:01">[00:15:01]</a>.
3.  **Conditional Authentication Check:** Use an If node to check the response of the HTTP request. If a valid user object (e.g., with an `email` attribute) is returned, authentication is successful, and the workflow continues <a class="yt-timestamp" data-t="00:15:41">[00:15:41]</a>. Otherwise, an error is returned <a class="yt-timestamp" data-t="00:15:59">[00:15:59]</a>.

!> While passing the Supabase API key directly as a parameter is simple, for higher security, it's advisable to store it in a secret management service like AWS Secrets Manager and fetch it within the workflow <a class="yt-timestamp" data-t="00:16:17">[00:16:17]</a>.

### Running and Testing with Authentication

After updating the n8n workflow and the Streamlit code with Supabase project URL and anonymous API key (public key), the Streamlit app can be rerun <a class="yt-timestamp" data-t="00:17:10">[00:17:10]</a>. Users will now be presented with a login/signup interface <a class="yt-timestamp" data-t="00:18:02">[00:18:02]</a>. While Claude might occasionally hallucinate or require iterative corrections for the UI, it generally corrects itself well <a class="yt-timestamp" data-t="00:18:37">[00:18:37]</a>. Upon successful login, the user's email and session ID can be displayed, confirming the robust authentication <a class="yt-timestamp" data-t="00:19:27">[00:19:27]</a>.

This setup provides a significant head start for [[tips_for_scalable_ai_agents_in_n8n | developing secure and robust interfaces]] for [[integrating_ai_agents_in_n8n_using_open_web_ui | n8n AI agents]] <a class="yt-timestamp" data-t="00:19:52">[00:19:52]</a>.