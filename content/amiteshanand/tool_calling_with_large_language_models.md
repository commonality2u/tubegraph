---
title: Tool Calling with Large Language Models
videoId: H-3VJ7usA58
---

From: [[amiteshanand]] <br/> 

Model Context Protocol (MCP) is an open-source framework launched by Anthropic, the company behind the large model Claude, that has significantly impacted the developer world. Since its launch approximately three months prior, it has seen widespread adoption due to its ability to fundamentally change how users interact with large language models (LLMs) <a class="yt-timestamp" data-t="00:00:00">[00:00:00]</a>.

## The Shift to Agentic AI

Traditionally, interaction with LLMs, like ChatGPT or Claude, has been limited to asking questions and receiving text-based responses <a class="yt-timestamp" data-t="00:00:16">[00:00:16]</a>. However, a significant shift is occurring with the rise of "agentic AI" <a class="yt-timestamp" data-t="00:00:28">[00:00:28]</a>. The core idea behind agentic AI is that these models can access external tools, moving beyond mere text generation to actively carry out tasks for users <a class="yt-timestamp" data-t="00:00:31">[00:00:31]</a>.

## What is Tool Calling?

A fundamental concept in agentic AI is "tool calling" <a class="yt-timestamp" data-t="00:00:41">[00:00:41]</a>. Since LLMs are inherently limited to text generation, they cannot directly perform actions like querying a real-time API or retrieving data from a user's database <a class="yt-timestamp" data-t="00:00:44">[00:00:44]</a>. Tool calling addresses this by allowing LLMs to gain access to external databases, APIs, and other tools <a class="yt-timestamp" data-t="00:00:57">[00:00:57]</a>.

Based on a user's input query, the LLM analyzes it to determine whether to provide a text-based response or to leverage one of the available tools <a class="yt-timestamp" data-t="00:01:05">[00:01:05]</a>. This enables the LLM to augment its responses with real-time updates or access to proprietary data stored in a database <a class="yt-timestamp" data-t="00:01:17">[00:01:17]</a>. MCP protocol specifically enhances LLMs like Claude to utilize these external tools and data, expanding potential use cases <a class="yt-timestamp" data-t="00:01:24">[00:01:24]</a>.

## Building an MCP Server

MCP servers can be built using TypeScript or Python SDKs <a class="yt-timestamp" data-t="00:01:45">[00:01:45]</a>. When these servers are defined with a set of tools, models like Claude can automatically identify and intelligently use these tools based on the user's prompt <a class="yt-timestamp" data-t="00:02:53">[00:02:53]</a>.

### JSON Input Schema

MCP requires a JSON input schema. This schema helps the LLM (e.g., Claude) understand how to process the user's prompt and how to structure the data for tool interaction. Responses generated by tools are also in JSON, which the LLM then uses to augment its final response <a class="yt-timestamp" data-t="00:03:30">[00:03:30]</a>. For type safety in TypeScript, Zod is used to define types, which are then converted to JSON schema using `zodToJsonSchema` <a class="yt-timestamp" data-t="00:03:52">[00:03:52]</a>.

### Example: Star Wars Planet Data Server

An example MCP server was demonstrated for retrieving Star Wars-related planet data <a class="yt-timestamp" data-t="00:02:03">[00:02:03]</a>. This server allows Claude to:
*   Retrieve data about Star Wars planets from a database like Couchbase <a class="yt-timestamp" data-t="00:02:16">[00:02:16]</a>.
*   Find related planets using Couchbase Vector Search <a class="yt-timestamp" data-t="00:02:21">[00:02:21]</a>.
*   Generate an image of a planet using [[Using Deep Learning Models for Content Generation | Nebius Studio]] <a class="yt-timestamp" data-t="00:02:24">[00:02:24]</a>.

The process involves:
1.  **Defining Data Types and Schema**: Initializing Star Wars data types, including planet names, rotation periods, and embeddings <a class="yt-timestamp" data-t="00:04:10">[00:04:10]</a>.
2.  **Setting Request Handlers**: Using `server.setRequestHandler` to define available tools for the MCP server <a class="yt-timestamp" data-t="00:04:46">[00:04:46]</a>. The name and description of the tool are crucial for Claude to identify the most relevant tool for a given input prompt <a class="yt-timestamp" data-t="00:05:13">[00:05:13]</a>.
    *   **`fetchPlanetName`**: Retrieves details about a specific planet (e.g., "tell me about the planet Naboo") <a class="yt-timestamp" data-t="00:05:28">[00:05:28]</a>.
    *   **`findSimilarPlanets`**: Identifies planets similar to a given one <a class="yt-timestamp" data-t="00:06:32">[00:06:32]</a>.
    *   **`generatePlanetImage`**: Creates an image for a specific planet (e.g., "generate an image for me for the planet Alderaan") <a class="yt-timestamp" data-t="00:05:38">[00:05:38]</a>.
3.  **Implementing Tool Functions**:
    *   **`getCharacter`**: Fetches planet details from a Couchbase database based on the planet name provided in the input query <a class="yt-timestamp" data-t="00:07:30">[00:07:30]</a>.
    *   **`findSimilarCharacters`**: Utilizes vector search. It retrieves the embedding for the input planet, defines a vector search index in Couchbase, and executes a vector search query to find the most closely matching embeddings. This returns planets with the closest features <a class="yt-timestamp" data-t="00:07:50">[00:07:50]</a>.
    *   **`generatePlanetImage`**: Uses [[Using Deep Learning Models for Content Generation | Nebius AI Studio]]'s text-to-image model (specifically the Flux model) <a class="yt-timestamp" data-t="00:09:16">[00:09:16]</a>. It uses the OpenAI client, providing the [[Using Deep Learning Models for Content Generation | Nebius Studio]] base URL and an API key. A detailed prompt (e.g., "realistic astronomical image of a Star Wars planet with the given name") is passed to the model, and the response is requested in base64 format, which is compatible with Claude MCP <a class="yt-timestamp" data-t="00:09:23">[00:09:23]</a>.
4.  **`model-context-protocol.json`**: This file defines environment variables used by the MCP <a class="yt-timestamp" data-t="00:10:13">[00:10:13]</a>.

## Demonstration of Tool Calling with Claude

When a user prompts Claude, for example, "Show me planets that are probably similar to the planet Alderaan and include an image of Alderaan" <a class="yt-timestamp" data-t="00:10:31">[00:10:31]</a>:
1.  Claude, running with the MCP, identifies the most appropriate tools from the registered set <a class="yt-timestamp" data-t="00:10:48">[00:10:48]</a>.
2.  It first uses the `findSimilarPlanets` tool. This tool fetches data for Alderaan from the Couchbase database, then uses vector search to find and return similar planets, along with a score indicating their closeness <a class="yt-timestamp" data-t="00:11:14">[00:11:14]</a>.
3.  Concurrently, Claude uses the `generatePlanetImage` tool. Based on the description of Alderaan, it calls the [[Using Deep Learning Models for Content Generation | Nebius AI Studio]] (Flux model) to generate a realistic image of the planet <a class="yt-timestamp" data-t="00:12:02">[00:12:02]</a>.
4.  Finally, Claude combines the information received from both tool calls (the list of similar planets with their climate, terrain, and other details from the structured JSON output, and the generated image) to provide a rich, augmented response to the user <a class="yt-timestamp" data-t="00:12:18">[00:12:18]</a>.

This demonstrates how Claude, even without inherent knowledge of Star Wars planets, can access external databases (Couchbase) and leverage external APIs ([[Using Deep Learning Models for Content Generation | Nebius Studio]]) to fulfill complex requests <a class="yt-timestamp" data-t="00:12:41">[00:12:41]</a>.

### Expanded Use Cases

The potential applications of tool calling are vast and limitless <a class="yt-timestamp" data-t="00:13:20">[00:13:20]</a>. For instance, an LLM could:
*   Find the latest weather in a specific location <a class="yt-timestamp" data-t="00:13:07">[00:13:07]</a>.
*   Access an external API to order clothes based on current weather conditions <a class="yt-timestamp" data-t="00:13:11">[00:13:11]</a>.
*   Even handle complex transactions by accessing payment information <a class="yt-timestamp" data-t="00:13:16">[00:13:16]</a>.

## MCP Tools in Claude Interface

When using Claude, the defined MCP tools are visible and accessible within the interface <a class="yt-timestamp" data-t="00:13:30">[00:13:30]</a>. Claude intelligently selects the appropriate tool based on the prompt and the tool's description <a class="yt-timestamp" data-t="00:13:41">[00:13:41]</a>.

Model Context Protocol significantly enhances the capabilities of large models by enabling [[Using ThirdParty Tools in AI Development | tool calling]]. This allows LLMs to not only generate text but also access external databases and tools, leading to more powerful and versatile agentic workflows <a class="yt-timestamp" data-t="00:14:03">[00:14:03]</a>.