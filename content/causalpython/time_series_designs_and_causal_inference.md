---
title: Time series designs and causal inference
videoId: gN-6DfhCguA
---

From: [[causalpython]] <br/> 

Time series designs, often referred to as N-of-1 trials, are studies focused on a single individual over time, where interventions are randomized <a class="yt-timestamp" data-t="00:00:00">[00:00:00]</a>. They are essentially randomized crossover designs <a class="yt-timestamp" data-t="00:02:44">[00:02:44]</a>. Unlike traditional trials meant to generalize to a broader population, N-of-1 trials are "personalized models" designed to generalize to the individual being studied, revealing patterns specific to them <a class="yt-timestamp" data-t="00:00:12">[00:00:12]</a>, <a class="yt-timestamp" data-t="00:00:21">[00:00:21]</a>, <a class="yt-timestamp" data-t="00:20:56">[00:20:56]</a>. In finance, N-of-1 trials are also known as switchback experiments <a class="yt-timestamp" data-t="00:15:17">[00:15:17]</a>.

## Inspiration for N-of-1 Trials

Dr. Eric Daza, a trained concert pianist and principal clinical data scientist, found his passion in statistics after starting in neurobiology <a class="yt-timestamp" data-t="00:01:32">[00:01:32]</a>, <a class="yt-timestamp" data-t="02:59:00">[02:59:00]</a>. His journey included studies at Cornell, Chapel Hill, and Stanford <a class="yt-timestamp" data-t="00:01:40">[00:01:40]</a>. A key turning point was taking a [[Causal inference and machine learning | causal inference]] course taught by Mark van der Laan, whom he initially didn't know was a leading figure in the field <a class="yt-timestamp" data-t="00:03:56">[00:03:56]</a>, <a class="yt-timestamp" data-t="00:04:10">[00:04:10]</a>. His interest in N-of-1 trials was further sparked by Susan Murphy's work on dynamic treatment regimes, a personalized branch of [[Causal inference and machine learning | causal inference]], and his loved one's experience with irritable bowel syndrome, an idiosyncratic chronic condition treatable with N-of-1 trials <a class="yt-timestamp" data-t="00:04:53">[00:04:53]</a>, <a class="yt-timestamp" data-t="00:05:20">[00:05:20]</a>, <a class="yt-timestamp" data-t="00:05:29">[00:05:29]</a>.

## Key Concepts and Challenges

### Serial Interference
Serial interference occurs when a person's treatment at one point in [[Time scale and its importance in causal models | time]] affects their potential outcomes at a future point in [[Time scale and its importance in causal models | time]] <a class="yt-timestamp" data-t="00:06:35">[00:06:35]</a>, <a class="yt-timestamp" data-t="00:06:46">[00:06:46]</a>. This is distinct from standard interference, which occurs between different people <a class="yt-timestamp" data-t="00:06:00">[00:06:00]</a>, <a class="yt-timestamp" data-t="00:11:18">[00:11:18]</a>. A key characteristic of serial interference is that future treatments cannot affect past outcomes <a class="yt-timestamp" data-t="00:07:02">[00:07:02]</a>, <a class="yt-timestamp" data-t="00:07:09">[00:07:09]</a>.

### Challenges in Time Series Designs
When applying [[Causal inference and machine learning | causal inference]] to time series data from a single individual, several challenges arise <a class="yt-timestamp" data-t="00:07:12">[00:07:12]</a>:
*   **Carryover Effects**: The effect of a treatment can "carry over" and impact future outcomes, inducing serial interference <a class="yt-timestamp" data-t="00:07:31">[00:07:31]</a>, <a class="yt-timestamp" data-t="00:07:42">[00:07:42]</a>.
*   **Autocorrelation**: Outcomes at different points in [[Time scale and its importance in causal models | time]] can be correlated (e.g., migraine chances today affecting chances tomorrow) <a class="yt-timestamp" data-t="00:07:54">[00:07:54]</a>, <a class="yt-timestamp" data-t="00:08:00">[00:08:00]</a>, <a class="yt-timestamp" data-t="00:13:37">[00:13:37]</a>.
*   **Exogenous Factors**: External factors not influenced by the treatment or outcome (e.g., weather) can affect outcomes over [[Time scale and its importance in causal models | time]] <a class="yt-timestamp" data-t="00:08:14">[00:08:14]</a>, <a class="yt-timestamp" data-t="00:08:16">[00:08:16]</a>, <a class="yt-timestamp" data-t="00:08:29">[00:08:29]</a>.

## Addressing Challenges and Applicability
N-of-1 designs are particularly useful for identifying "triggers" and recurring patterns for outcomes that have very heterogeneous triggers across different people <a class="yt-timestamp" data-t="00:09:03">[00:09:03]</a>, <a class="yt-timestamp" data-t="00:09:34">[00:09:34]</a>. For example, coffee might worsen migraines for one person but prevent them for another <a class="yt-timestamp" data-t="00:09:42">[00:09:42]</a>. In such cases, a traditional group-based randomized control trial might find no average treatment effect, as individual effects cancel out <a class="yt-timestamp" data-t="00:09:50">[00:09:50]</a>, <a class="yt-timestamp" data-t="00:09:57">[00:09:57]</a>.

These designs are applicable for recurring conditions <a class="yt-timestamp" data-t="00:39:12">[00:39:12]</a>. If an event is irreversible (like death), it cannot be studied as an N-of-1 trial <a class="yt-timestamp" data-t="00:39:15">[00:39:15]</a>.

### Average Period Treatment Effect (APTE)
The Average Period Treatment Effect (APTE) is an estimate used in N-of-1 trials <a class="yt-timestamp" data-t="00:10:45">[00:10:45]</a>. Similar to the Average Treatment Effect (ATE) in traditional randomized controlled trials, the APTE compares average outcomes between two or more treatment levels <a class="yt-timestamp" data-t="00:10:51">[00:10:51]</a>. The "period" in APTE signifies that the comparison is across different time periods for the same person, accounting for serial interference <a class="yt-timestamp" data-t="00:11:32">[00:11:32]</a>, <a class="yt-timestamp" data-t="00:11:41">[00:11:41]</a>.

## Statistical Machinery and Assumptions
The main difference in the statistical analysis for N-of-1 trials compared to group-based studies is the time series setting <a class="yt-timestamp" data-t="00:13:35">[00:13:35]</a>.
*   **Independence vs. Stationarity**: The assumption of independence between participants in group-based studies is replaced by assumptions like stationarity in time series <a class="yt-timestamp" data-t="00:12:48">[00:12:48]</a>, <a class="yt-timestamp" data-t="00:12:56">[00:12:56]</a>. Stationarity implies that averages remain consistent over a given time span <a class="yt-timestamp" data-t="00:12:59">[00:12:59]</a>.
*   **Dealing with Autocorrelation**: While an independence assumption for errors can still be achieved, it requires controlling for factors like lag and autocorrelation <a class="yt-timestamp" data-t="00:13:22">[00:13:22]</a>, <a class="yt-timestamp" data-t="00:13:31">[00:13:31]</a>.
*   **Non-Stationarity**: One challenge is non-stationarity of background factors. In classic N-of-1 trials, clinicians and patients co-design the study, controlling exposure components, washout periods, and randomization, ensuring the time series are relatively stationary by design <a class="yt-timestamp" data-t="00:41:40">[00:41:40]</a>. In real-world settings, strategies like "stationarization" (e.g., taking first differences) or segmenting the time series into stationary periods (e.g., using changepoint detection) can be used, though these may change the study question <a class="yt-timestamp" data-t="00:43:39">[00:43:39]</a>, <a class="yt-timestamp" data-t="00:44:17">[00:44:17]</a>. Diagnostics in modeling are crucial to detect shifting time series <a class="yt-timestamp" data-t="00:44:09">[00:44:09]</a>.

## Causal Identification Frameworks
When considering [[Causal inference and individual treatment effects | causal identification]] in N-of-1 trials, Dr. Daza primarily uses the potential outcomes framework <a class="yt-timestamp" data-t="00:18:19">[00:18:19]</a>. He finds Directed Acyclic Graphs (DAGs) from Pearl's framework particularly useful because of their visual nature <a class="yt-timestamp" data-t="00:18:31">[00:18:31]</a>, <a class="yt-timestamp" data-t="00:18:40">[00:18:40]</a>. DAGs help in writing out equations to assess identifiability and construct models for estimation <a class="yt-timestamp" data-t="00:18:47">[00:18:47]</a>, <a class="yt-timestamp" data-t="00:18:56">[00:18:56]</a>. For time series, DAGs are especially insightful as they force recursive drawing of arrows from the past to the present, clarifying model inclusions and implicit [[Assumptions in causal inference | assumptions]] <a class="yt-timestamp" data-t="00:19:11">[00:19:11]</a>, <a class="yt-timestamp" data-t="00:19:27">[00:19:27]</a>.

## Advice for Designing and Running N-of-1 Studies
The most important advice for designing N-of-1 studies is to focus on the specific study question <a class="yt-timestamp" data-t="00:22:10">[00:22:10]</a>, <a class="yt-timestamp" data-t="00:22:37">[00:22:37]</a>.
*   **Specify Variables**: Clearly define what variables will be collected and how they will be measured (e.g., passive sensors, daily diaries, lab values) <a class="yt-timestamp" data-t="00:22:15">[00:22:15]</a>.
*   **Feasibility**: Consider the feasibility of data collection given limited time, money, and patience <a class="yt-timestamp" data-t="00:22:24">[00:22:24]</a>, <a class="yt-timestamp" data-t="00:22:47">[00:22:47]</a>.
*   **"Design Trumps Analysis"**: Emphasizing Rubin's quote, the design stage is paramount. Thinking about the study question, variables, [[Time scale and its importance in causal models | timeline]], and [[Data preparation for causal analysis | data collection]] methods is more important than the analysis itself, as poor design leads to unreliable conclusions <a class="yt-timestamp" data-t="00:13:13">[00:13:13]</a>, <a class="yt-timestamp" data-t="00:23:11">[00:23:11]</a>, <a class="yt-timestamp" data-t="00:59:51">[00:59:51]</a>.

## Software Ecosystem
Several software tools and platforms can assist in N-of-1 studies:
*   **Tummy Trials**: An early app for people with irritable bowel syndrome <a class="yt-timestamp" data-t="00:24:17">[00:24:17]</a>.
*   **Migraine Buddy**: More for self-tracking, less for self-experiment design <a class="yt-timestamp" data-t="00:24:39">[00:24:39]</a>.
*   **Study Me**: A promising newer package developed by Stefan Konorski <a class="yt-timestamp" data-t="00:24:52">[00:24:52]</a>.

## Future Directions and Research
Dr. Daza highlights several promising areas for advancing N-of-1 trials and related fields:
*   **Functional Data Analysis (FDA)**: This field examines entire curves of data over [[Time scale and its importance in causal models | time]] (e.g., step counts or blood glucose curves over a day) rather than just averages, allowing for the study of how these curves differ under various conditions <a class="yt-timestamp" data-t="00:14:50">[00:14:50]</a>, <a class="yt-timestamp" data-t="00:45:59">[00:45:59]</a>.
*   **Control Theory and System Identification**: A recent preprint connecting [[Causal inference and machine learning | causal inference]] to control theory and system identification is exciting <a class="yt-timestamp" data-t="00:46:57">[00:46:57]</a>. These engineering techniques could be used to optimize human behavior, aiming to bring individuals to stable points or to a desired state <a class="yt-timestamp" data-t="00:47:23">[00:47:23]</a>, <a class="yt-timestamp" data-t="00:47:28">[00:47:28]</a>. This also relates to learning reliable world models for agentic systems <a class="yt-timestamp" data-t="00:47:50">[00:47:50]</a>.

## Resources
*   **Stats of One Newsletter**: A newsletter focusing on statistical methods, [[Data preparation for causal analysis | data collection]], and software related to N-of-1 trials and single-case designs <a class="yt-timestamp" data-t="00:14:10">[00:14:10]</a>. It draws resources from fields like psychology, education, time series, [[Functional data analysis | functional data analysis]], and econometrics/[[Causal inference in finance | finance]] <a class="yt-timestamp" data-t="00:14:34">[00:14:34]</a>, <a class="yt-timestamp" data-t="00:15:09">[00:15:09]</a>. The goal is to connect insights across these diverse literatures <a class="yt-timestamp" data-t="00:15:36">[00:15:36]</a>.
*   **N-of-1 Collaborative Network**: A fantastic group based in Australia that has been popularizing the design and implementation of N-of-1 trials for decades <a class="yt-timestamp" data-t="00:17:08">[00:17:08]</a>, <a class="yt-timestamp" data-t="00:17:13">[00:17:13]</a>. They offer a consulting service <a class="yt-timestamp" data-t="00:45:31">[00:45:31]</a>.

### Distinguishing [[Causal inference and individual treatment effects | Individual Treatment Effects]]
While N-of-1 trials are designed for individual subjects, it's important to distinguish them from the concept of "individual treatment effects" as commonly understood in some literature. Dr. Daza and colleagues argue that what is often called an "individual treatment effect" is more accurately a "small group treatment effect," as the logical chain continues to an individual person <a class="yt-timestamp" data-t="00:38:48">[00:38:48]</a>, <a class="yt-timestamp" data-t="00:39:01">[00:39:01]</a>. The fundamental problem of [[Causal inference and individual treatment effects | causal inference]] still applies: at any given point, only one exposure was taken, so the counterfactual outcome remains unobserved, even when dealing with one person over [[Time scale and its importance in causal models | time]] <a class="yt-timestamp" data-t="00:41:15">[00:41:15]</a>, <a class="yt-timestamp" data-t="00:41:24">[00:41:24]</a>.