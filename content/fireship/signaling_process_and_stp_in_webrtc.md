---
title: Signaling process and STP in WebRTC
videoId: WmR9IMUD_CY
---

From: [[fireship]] <br/> 

[[introduction_to_webrtc | WebRTC]] enables the exchange of real-time audio and video streams entirely within the browser <a class="yt-timestamp" data-t="00:00:00">[00:00:00]</a>. It allows for the establishment of a peer-to-peer connection between two or more browsers, enabling them to exchange audio and video media directly, without the need for a third-party server or native application <a class="yt-timestamp" data-t="00:00:17">[00:00:17]</a>.

## What is Signaling?

Signaling is the process by which two peers, wanting to establish a [[introduction_to_webrtc | WebRTC]] connection, exchange control messages to coordinate communication <a class="yt-timestamp" data-t="00:00:50">[00:00:50]</a>. This process is handled by a third-party signaling server <a class="yt-timestamp" data-t="00:00:51">[00:00:51]</a>. The signaling server's primary role is to securely exchange connection data between the two parties, but it never handles or touches the actual media transmitted between the peers <a class="yt-timestamp" data-t="00:00:54">[00:00:54]</a>.

The vast majority of the work in building a [[decentralized_chat_application | video chat app]] with [[introduction_to_webrtc | WebRTC]] involves signaling data between the two users <a class="yt-timestamp" data-t="00:10:55">[00:10:55]</a>.

## The Offer/Answer Model

The signaling process typically follows an offer/answer model:

1.  **Creating an Offer**
    *   The first peer, known as the caller, creates an offer asking another peer to connect <a class="yt-timestamp" data-t="00:00:27">[00:00:27]</a>.
    *   This action results in an [[introduction_to_webrtc | SDP]] object, or Session Description Protocol <a class="yt-timestamp" data-t="00:00:31">[00:00:31]</a>.
    *   This [[introduction_to_webrtc | SDP]] object contains information describing the peer-to-peer connection, such as the video codec, timing, and other negotiation details <a class="yt-timestamp" data-t="00:00:36">[00:00:36]</a>.
    *   The caller saves this offer data to a server <a class="yt-timestamp" data-t="00:00:40">[00:00:40]</a>, which can then be read by the answering peer <a class="yt-timestamp" data-t="00:00:42">[00:00:42]</a>.
    *   Creating a local description on the peer connection automatically starts generating [[using_ice_for_connectivity_in_webrtc | ICE]] candidates <a class="yt-timestamp" data-t="00:08:13">[00:08:13]</a>. These candidates are then written to the signaling server as part of the offer <a class="yt-timestamp" data-t="00:08:34">[00:08:34]</a>.

2.  **Answering the Call**
    *   The answering peer reads the offer data from the server <a class="yt-timestamp" data-t="00:00:42">[00:00:42]</a>.
    *   It then creates an [[introduction_to_webrtc | SDP]] answer <a class="yt-timestamp" data-t="00:00:45">[00:00:45]</a> and writes it to the same signaling server <a class="yt-timestamp" data-t="00:00:48">[00:00:48]</a>.
    *   The answer also contains [[using_ice_for_connectivity_in_webrtc | ICE]] candidates generated by the answering peer, which are then written to the database <a class="yt-timestamp" data-t="00:10:10">[00:10:10]</a>.

Once the offer and answer (along with [[using_ice_for_connectivity_in_webrtc | ICE]] candidates) have been exchanged via the signaling server, [[introduction_to_webrtc | WebRTC]] can establish the direct peer-to-peer connection <a class="yt-timestamp" data-t="00:03:27">[00:03:27]</a>.

## Session Description Protocol (SDP)

The Session Description Protocol ([[introduction_to_webrtc | SDP]]) is a key component of the signaling process <a class="yt-timestamp" data-t="00:00:31">[00:00:31]</a>. It is an object that contains all the necessary information to describe the peer-to-peer connection, such as:
*   Video codec details <a class="yt-timestamp" data-t="00:00:38">[00:00:38]</a>
*   Timing information <a class="yt-timestamp" data-t="00:00:39">[00:00:39]</a>
*   Other specifications needed to negotiate the connection <a class="yt-timestamp" data-t="00:08:06">[00:08:06]</a>

## Signaling Server Implementation Example

In a [[building_a_peertopeer_video_chat_app | video chat app]] built with vanilla JavaScript, [[setting_up_firebase_for_signaling_in_video_chat_apps | Firebase]] can be used as the signaling server <a class="yt-timestamp" data-t="00:02:18">[00:02:18]</a>.

[[setting_up_firebase_for_signaling_in_video_chat_apps | Firebase]] is an excellent choice for a signaling server because it simplifies listening to real-time updates to the database <a class="yt-timestamp" data-t="00:04:05">[00:04:05]</a>. This eliminates the need to implement complex solutions like WebSockets, which would typically be required with a traditional database for real-time updates <a class="yt-timestamp" data-t="00:04:11">[00:04:11]</a>.

### Data Model for Signaling with Firebase

When using [[setting_up_firebase_for_signaling_in_video_chat_apps | Firebase]] as a signaling server, a common data model involves:
*   A `call` document to manage the offer and answer from both users <a class="yt-timestamp" data-t="00:07:05">[00:07:05]</a>.
*   Sub-collections under the `call` document for `offerCandidates` and `answerCandidates`, which contain all the [[using_ice_for_connectivity_in_webrtc | ICE]] candidates for each user <a class="yt-timestamp" data-t="00:07:10">[00:07:10]</a>.

This data model allows signaling to take place between the two peers <a class="yt-timestamp" data-t="00:03:16">[00:03:16]</a>. The [[using_ice_for_connectivity_in_webrtc | ICE]] candidate data, though appearing as "nonsense," contains the IP address and port pair necessary for the peers to establish a connection <a class="yt-timestamp" data-t="00:03:20">[00:03:20]</a>.

### Signaling Flow with Firebase

1.  **Call Creation (Caller)**
    *   The caller creates a call, which writes a document to Firestore with the offer details <a class="yt-timestamp" data-t="00:02:44">[00:02:44]</a>.
    *   A unique ID for the offer is generated and can be shared with another user <a class="yt-timestamp" data-t="00:02:55">[00:02:55]</a>.
    *   The caller's [[introduction_to_webrtc | `RTCPeerConnection`]] instance generates [[using_ice_for_connectivity_in_webrtc | ICE]] candidates, which are then written to the `offerCandidates` sub-collection in the database <a class="yt-timestamp" data-t="00:03:08">[00:03:08]</a>.
    *   The caller's peer connection also listens for changes to the `call` document in Firestore to receive the answer from the other user <a class="yt-timestamp" data-t="00:08:47">[00:08:47]</a> and listens to the `answerCandidates` collection for incoming [[using_ice_for_connectivity_in_webrtc | ICE]] candidates <a class="yt-timestamp" data-t="00:09:23">[00:09:23]</a>.

2.  **Joining a Call (Answerer)**
    *   The answering user joins the call using the unique ID <a class="yt-timestamp" data-t="00:03:00">[00:03:00]</a>.
    *   They establish their own peer connection <a class="yt-timestamp" data-t="00:03:04">[00:03:04]</a>.
    *   The answerer fetches the call document from the database to retrieve the offer data <a class="yt-timestamp" data-t="00:10:15">[00:10:15]</a>.
    *   They set the retrieved offer as the remote description on their peer connection <a class="yt-timestamp" data-t="00:10:22">[00:10:22]</a>.
    *   An answer is then generated locally and set as the local description <a class="yt-timestamp" data-t="00:10:26">[00:10:26]</a>.
    *   This answer is updated on the `call` document in Firestore so the caller can receive it <a class="yt-timestamp" data-t="00:10:36">[00:10:36]</a>.
    *   The answerer's peer connection generates [[using_ice_for_connectivity_in_webrtc | ICE]] candidates, which are written to the `answerCandidates` collection <a class="yt-timestamp" data-t="00:10:07">[00:10:07]</a>.
    *   The answerer also listens for updates to the `offerCandidates` collection to receive the caller's [[using_ice_for_connectivity_in_webrtc | ICE]] candidates <a class="yt-timestamp" data-t="00:10:41">[00:10:41]</a>.

Once signaling is complete, [[introduction_to_webrtc | WebRTC]] handles the complex peer-to-peer networking and media streaming under the hood <a class="yt-timestamp" data-t="00:10:59">[00:10:59]</a>.