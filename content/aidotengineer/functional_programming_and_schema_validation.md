---
title: Functional programming and schema validation
videoId: sXXl3YMU7ZI
---

From: [[aidotengineer]] <br/> 

14.ai, an AI-native customer support platform, leverages [[typescript_and_effect_library_usage | Effect]], a TypeScript library, to build robust, type-safe, and composable systems, especially when dealing with unreliable APIs, complex dependencies, non-deterministic model outputs, and long-running workflows <a class="yt-timestamp" data-t="00:00:16">[00:00:16]</a>. [[typescript_and_effect_library_usage | Effect]] extends [[typescript_and_effect_library_usage | TypeScript]]'s foundation to provide strong type guarantees, powerful composition primitives, and structured error modeling <a class="yt-timestamp" data-t="00:00:44">[00:00:44]</a>.

## Why Effect for Robust Systems?

[[typescript_and_effect_library_usage | Effect]] provides a foundational framework for tackling the [[challenges_of_building_robust_and_reusable_tools | complexity of building robust and reusable tools]] in production, particularly for systems that interact directly with end-users and rely on LLMs <a class="yt-timestamp" data-t="00:00:07">[00:00:07]</a>. Key features that contribute to this robustness include:

*   **Type Guarantees & Composition**: Strong type guarantees across the entire stack and powerful composition primitives <a class="yt-timestamp" data-t="00:00:44">[00:00:44]</a>.
*   **Built-in Mechanisms**: Concurrency, streaming, interruptions, and retry mechanisms are built-in <a class="yt-timestamp" data-t="00:00:50">[00:00:50]</a>.
*   **Structured Error Modeling**: A structured approach to handling errors <a class="yt-timestamp" data-t="00:00:54">[00:00:54]</a>.
*   **Clean [[dependency_injection_and_testing_in_typescript | Dependency Injection]]**: Simplifies [[dependency_injection_and_testing_in_typescript | testing]] and modernization <a class="yt-timestamp" data-t="00:00:57">[00:00:57]</a>.

## Schema Validation with Effect Schemas

A cornerstone of 14.ai's architecture is the pervasive use of Effect schemas, which model everything across their stack <a class="yt-timestamp" data-t="02:15">[02:15]</a>. This schema-centric approach offers significant advantages:

*   **Runtime Validation**: Ensures data integrity at runtime <a class="yt-timestamp" data-t="02:17">[02:17]</a>.
*   **Encoding and Decoding**: Provides powerful built-in encoding and decoding capabilities <a class="yt-timestamp" data-t="02:19">[02:19]</a>.
*   **Type-Safe Handling**: Guarantees type-safe input and output handling throughout the system <a class="yt-timestamp" data-t="02:21">[02:21]</a>.
*   **Autogenerated Documentation**: Schemas automatically generate documentation, ensuring clarity and consistency without extra effort <a class="yt-timestamp" data-t="02:23">[02:23]</a>.
*   **Input, Output, and Error Types**: Explicitly defines input, output, and error types upfront <a class="yt-timestamp" data-t="04:32">[04:32]</a>.

### Architectural Integration
Effect schemas are integral to various components of 14.ai's platform:
*   **RPC Server**: Handles application logic using Effect RPC <a class="yt-timestamp" data-t="01:40">[01:40]</a>.
*   **Public API Server**: Employs Effect HTTP, with OpenAPI documentation autogenerated from annotated schemas <a class="yt-timestamp" data-t="01:47">[01:47]</a>.
*   **Database Interactions**: Effect SQL is used for queries with PostgreSQL, covering both data and vector storage <a class="yt-timestamp" data-t="02:10">[02:10]</a>.

## Functional Programming Principles

[[typescript_and_effect_library_usage | Effect]] brings the rigor of [[ocaml_and_functional_programming | functional programming]] into real-world [[typescript_and_effect_library_usage | TypeScript]] development in a practical way <a class="yt-timestamp" data-t="07:01">[07:01]</a>. This is evident in its "functional pipe-based system," which forms the foundation for building domain-specific languages (DSLs) for agent workflows <a class="yt-timestamp" data-t="03:17">[03:17]</a>. This allows for clear and composable expression of complex logic, including branching, sequencing, retries, state transitions, and memory <a class="yt-timestamp" data-t="03:24">[03:24]</a>.

## Developer Experience and Guard Rails

The schema-centric nature and [[ocaml_and_functional_programming | functional programming]] influence of [[typescript_and_effect_library_usage | Effect]] significantly enhance developer experience:

*   **Schema-Centric Development**: Defining types upfront with schemas provides strong type safety guarantees and auto-documentation <a class="yt-timestamp" data-t="04:31">[04:31]</a>.
*   **Predictable Dependencies**: [[dependency_injection_and_testing_in_typescript | Dependency injection]] ensures services are provided at the entry point and are guaranteed at compile time, making them easily mockable for [[dependency_injection_and_testing_in_typescript | testing]] <a class="yt-timestamp" data-t="04:48">[04:48]</a>. Services are modular and composable, allowing for easy overrides or swaps of implementations <a class="yt-timestamp" data-t="05:06">[05:06]</a>.
*   **Strong Guard Rails**: [[typescript_and_effect_library_usage | Effect]] helps prevent common mistakes, enabling new engineers to become productive quickly and making it harder to fall into bad patterns after the initial learning curve <a class="yt-timestamp" data-t="05:14">[05:14]</a>.

## Lessons Learned

While powerful, using [[typescript_and_effect_library_usage | Effect]] effectively requires discipline. It's crucial to be careful when catching errors upstream to avoid silently losing important failures <a class="yt-timestamp" data-t="05:49">[05:49]</a>. [[dependency_injection_and_testing_in_typescript | Dependency injection]], while great in principle, can be challenging to grasp at scale, especially when tracing services across multiple layers <a class="yt-timestamp" data-t="05:57">[05:57]</a>. The initial learning curve for [[typescript_and_effect_library_usage | Effect]] can be overwhelming due to its vast ecosystem, but overcoming this "bump" leads to compounding benefits <a class="yt-timestamp" data-t="06:13">[06:13]</a>.

## Incremental Adoption and LLM Systems

[[typescript_and_effect_library_usage | Effect]] allows for [[incremental_adoption_of_effect_in_typescript_projects | incremental adoption]], meaning teams don't have to fully commit on day one but can start with a single service or endpoint <a class="yt-timestamp" data-t="06:37">[06:37]</a>. This is particularly beneficial for LLM and AI-based systems where reliability and handling non-determinism are critical <a class="yt-timestamp" data-t="06:47">[06:47]</a>. [[typescript_and_effect_library_usage | Effect]] helps make these systems predictable and observable <a class="yt-timestamp" data-t="06:53">[06:53]</a>. It enables developers to integrate [[ocaml_and_functional_programming | functional programming]] rigor into [[typescript_and_effect_library_usage | TypeScript]] in a way that is practical for production use, even for those who aren't [[ocaml_and_functional_programming | functional programming]] purists <a class="yt-timestamp" data-t="07:03">[07:03]</a>.